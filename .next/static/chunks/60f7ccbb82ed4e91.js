(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,37727,12156,e=>{"use strict";var t=e.i(75254);let s=(0,t.default)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);e.s(["X",()=>s],37727);let a=(0,t.default)("Pill",[["path",{d:"m10.5 20.5 10-10a4.95 4.95 0 1 0-7-7l-10 10a4.95 4.95 0 1 0 7 7Z",key:"wa1lgi"}],["path",{d:"m8.5 8.5 7 7",key:"rvfmvr"}]]);e.s(["Pill",()=>a],12156)},55436,63209,e=>{"use strict";var t=e.i(75254);let s=(0,t.default)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);e.s(["Search",()=>s],55436);let a=(0,t.default)("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);e.s(["AlertCircle",()=>a],63209)},75254,e=>{"use strict";var t=e.i(71645);let s=(...e)=>e.filter((e,t,s)=>!!e&&""!==e.trim()&&s.indexOf(e)===t).join(" ").trim();var a={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let r=(0,t.forwardRef)(({color:e="currentColor",size:r=24,strokeWidth:l=2,absoluteStrokeWidth:n,className:i="",children:c,iconNode:d,...o},x)=>(0,t.createElement)("svg",{ref:x,...a,width:r,height:r,stroke:e,strokeWidth:n?24*Number(l)/Number(r):l,className:s("lucide",i),...o},[...d.map(([e,s])=>(0,t.createElement)(e,s)),...Array.isArray(c)?c:[c]])),l=(e,a)=>{let l=(0,t.forwardRef)(({className:l,...n},i)=>(0,t.createElement)(r,{ref:i,iconNode:a,className:s(`lucide-${e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,l),...n}));return l.displayName=`${e}`,l};e.s(["default",()=>l],75254)},27612,e=>{"use strict";let t=(0,e.i(75254).default)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);e.s(["Trash2",()=>t],27612)},69638,e=>{"use strict";let t=(0,e.i(75254).default)("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);e.s(["CheckCircle",()=>t],69638)},84614,e=>{"use strict";let t=(0,e.i(75254).default)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);e.s(["User",()=>t],84614)},61911,e=>{"use strict";let t=(0,e.i(75254).default)("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);e.s(["Users",()=>t],61911)},7233,e=>{"use strict";let t=(0,e.i(75254).default)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);e.s(["Plus",()=>t],7233)},56909,27516,e=>{"use strict";var t=e.i(75254);let s=(0,t.default)("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);e.s(["Save",()=>s],56909);let a=(0,t.default)("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]);e.s(["History",()=>a],27516)},90392,e=>{"use strict";var t=e.i(43476),s=e.i(71645),a=e.i(7471),r=e.i(37727),l=e.i(75254);let n=(0,l.default)("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);var i=e.i(84614),c=e.i(12156);let d=(0,l.default)("Activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]);function o({patient:e,onClose:l}){let[o,x]=(0,s.useState)([]),[h,m]=(0,s.useState)(!1);async function u(){m(!0);let{data:t,error:s}=await a.supabase.from("visits").select(`
                *,
                prescriptions (*),
                services (*)
            `).eq("patient_id",e.id).order("created_at",{ascending:!1});t&&x(t),m(!1)}return((0,s.useEffect)(()=>{e&&u()},[e]),e)?(0,t.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm p-4 animate-in fade-in duration-200",children:(0,t.jsxs)("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-4xl max-h-[90vh] flex flex-col overflow-hidden",children:[(0,t.jsxs)("div",{className:"p-4 border-b flex justify-between items-center bg-blue-50",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("h2",{className:"text-xl font-bold text-blue-800 flex items-center gap-2",children:[(0,t.jsx)(d,{className:"text-blue-600"})," Lịch sử Khám bệnh"]}),(0,t.jsxs)("p",{className:"text-sm text-blue-600 font-medium mt-1",children:["Bệnh nhân: ",e.full_name," - CCCD: ",e.cccd]})]}),(0,t.jsx)("button",{onClick:l,className:"p-2 hover:bg-blue-100 rounded-full transition-colors text-blue-800",children:(0,t.jsx)(r.X,{size:24})})]}),(0,t.jsx)("div",{className:"flex-1 overflow-y-auto p-6 bg-gray-50",children:h?(0,t.jsx)("div",{className:"text-center py-10 text-gray-500",children:"Đang tải dữ liệu..."}):0===o.length?(0,t.jsx)("div",{className:"text-center py-10 text-gray-500 italic",children:"Chưa có lịch sử khám nào."}):(0,t.jsx)("div",{className:"space-y-6",children:o.map(e=>(0,t.jsxs)("div",{className:"bg-white rounded-lg border shadow-sm overflow-hidden",children:[(0,t.jsxs)("div",{className:"bg-gray-100 p-3 border-b flex justify-between items-center",children:[(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsxs)("span",{className:"font-bold text-gray-700 flex items-center gap-1",children:[(0,t.jsx)(n,{size:16})," ",new Date(e.created_at).toLocaleDateString("vi-VN")," ",new Date(e.created_at).toLocaleTimeString("vi-VN",{hour:"2-digit",minute:"2-digit"})]}),(0,t.jsx)("span",{className:`text-xs px-2 py-1 rounded-full border ${"Done"===e.status?"bg-green-100 text-green-700 border-green-200":"bg-gray-100 text-gray-600 border-gray-200"}`,children:"Done"===e.status?"Hoàn thành":e.status})]}),(0,t.jsxs)("div",{className:"text-sm text-gray-600 flex items-center gap-1",children:[(0,t.jsx)(i.User,{size:14})," BS: ",(0,t.jsx)("span",{className:"font-medium",children:e.doctor_by||"N/A"})]})]}),(0,t.jsxs)("div",{className:"p-4 grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"Lý do khám"}),(0,t.jsx)("p",{className:"text-sm text-gray-800 bg-gray-50 p-2 rounded border border-gray-100 mt-1",children:e.reason||"-"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"Chẩn đoán / Kết luận"}),(0,t.jsx)("p",{className:"text-sm font-medium text-blue-900 bg-blue-50 p-2 rounded border border-blue-100 mt-1",children:e.conclusion||"Chưa có kết luận"})]})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[e.services&&e.services.length>0&&(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Dịch vụ đã làm"}),(0,t.jsx)("div",{className:"flex flex-wrap gap-2",children:e.services.map(e=>(0,t.jsx)("span",{className:"text-xs bg-purple-50 text-purple-700 border border-purple-200 px-2 py-1 rounded",children:e.service_type},e.id))})]}),e.prescriptions&&e.prescriptions.length>0&&e.prescriptions[0].medication_data&&(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block flex items-center gap-1",children:[(0,t.jsx)(c.Pill,{size:12})," Đơn thuốc"]}),(0,t.jsx)("div",{className:"bg-yellow-50 border border-yellow-200 rounded p-2 text-xs space-y-1",children:e.prescriptions[0].medication_data.map((e,s)=>(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsxs)("span",{className:"font-medium text-gray-700",children:["• ",e.name]}),(0,t.jsx)("span",{className:"text-gray-500",children:e.qty})]},s))})]})]})]})]},e.id))})})]})}):null}e.s(["default",()=>o],90392)},72906,e=>{"use strict";var t=e.i(43476),s=e.i(71645),a=e.i(7471),r=e.i(7233),l=e.i(75254);let n=(0,l.default)("Pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]);var i=e.i(27612),c=e.i(56909),d=e.i(37727);let o=(0,l.default)("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);function x(){let[e,l]=(0,s.useState)([]),[x,h]=(0,s.useState)(!1),[m,u]=(0,s.useState)(null),[p,g]=(0,s.useState)({name:"",role:"Receptionist"});async function b(){h(!0);let{data:e}=await a.supabase.from("staff").select("*").order("id",{ascending:!0});e&&l(e),h(!1)}async function y(){if(!p.name||!p.role)return alert("Vui lòng nhập tên và chức vụ");if(m){let{error:e}=await a.supabase.from("staff").update(p).eq("id",m);e||(u(null),g({name:"",role:"Receptionist"}),b())}else{let{error:e}=await a.supabase.from("staff").insert([p]);e||(g({name:"",role:"Receptionist"}),b())}}async function f(e,t){let{error:s}=await a.supabase.from("staff").update({is_active:!t}).eq("id",e);s||b()}return(0,s.useEffect)(()=>{b()},[]),(0,t.jsxs)("div",{className:"bg-white p-6 rounded-xl border shadow-sm",children:[(0,t.jsxs)("h3",{className:"text-lg font-bold mb-4 flex items-center gap-2",children:[(0,t.jsx)(o,{size:20,className:"text-primary"})," Quản lý Nhân sự"]}),(0,t.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg mb-6 flex gap-4 items-end border",children:[(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("label",{className:"block text-xs font-medium mb-1 text-gray-500",children:"Họ tên nhân viên"}),(0,t.jsx)("input",{type:"text",className:"w-full border p-2 rounded text-sm",placeholder:"VD: Nguyễn Văn A",value:p.name,onChange:e=>g({...p,name:e.target.value})})]}),(0,t.jsxs)("div",{className:"w-48",children:[(0,t.jsx)("label",{className:"block text-xs font-medium mb-1 text-gray-500",children:"Chức vụ"}),(0,t.jsxs)("select",{className:"w-full border p-2 rounded text-sm",value:p.role,onChange:e=>g({...p,role:e.target.value}),children:[(0,t.jsx)("option",{value:"Receptionist",children:"Lễ tân"}),(0,t.jsx)("option",{value:"Doctor",children:"Bác sĩ"}),(0,t.jsx)("option",{value:"Technician",children:"Kỹ thuật viên"})]})]}),(0,t.jsxs)("button",{onClick:y,className:"bg-primary text-white px-4 py-2 rounded flex items-center gap-2 hover:bg-blue-600 transition-colors text-sm",children:[m?(0,t.jsx)(c.Save,{size:16}):(0,t.jsx)(r.Plus,{size:16}),m?"Lưu":"Thêm"]}),m&&(0,t.jsx)("button",{onClick:function(){u(null),g({name:"",role:"Receptionist"})},className:"bg-gray-200 text-gray-700 px-4 py-2 rounded hover:bg-gray-300 transition-colors text-sm",children:(0,t.jsx)(d.X,{size:16})})]}),(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsxs)("table",{className:"w-full text-sm text-left",children:[(0,t.jsx)("thead",{className:"bg-gray-100 text-gray-600 font-medium",children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{className:"p-3 rounded-tl-lg",children:"ID"}),(0,t.jsx)("th",{className:"p-3",children:"Họ tên"}),(0,t.jsx)("th",{className:"p-3",children:"Chức vụ"}),(0,t.jsx)("th",{className:"p-3",children:"Trạng thái"}),(0,t.jsx)("th",{className:"p-3 rounded-tr-lg text-right",children:"Thao tác"})]})}),(0,t.jsx)("tbody",{className:"divide-y",children:e.map(e=>(0,t.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,t.jsxs)("td",{className:"p-3 text-gray-500",children:["#",e.id]}),(0,t.jsx)("td",{className:"p-3 font-medium",children:e.name}),(0,t.jsx)("td",{className:"p-3",children:(0,t.jsx)("span",{className:`px-2 py-1 rounded text-xs font-medium border ${"Doctor"===e.role?"bg-blue-50 text-blue-700 border-blue-200":"Receptionist"===e.role?"bg-purple-50 text-purple-700 border-purple-200":"bg-orange-50 text-orange-700 border-orange-200"}`,children:"Doctor"===e.role?"Bác sĩ":"Receptionist"===e.role?"Lễ tân":"KTV"})}),(0,t.jsx)("td",{className:"p-3",children:(0,t.jsxs)("span",{className:`text-xs flex items-center gap-1 ${e.is_active?"text-green-600":"text-gray-400"}`,children:[(0,t.jsx)("span",{className:`w-2 h-2 rounded-full ${e.is_active?"bg-green-500":"bg-gray-300"}`}),e.is_active?"Hoạt động":"Đã ẩn"]})}),(0,t.jsxs)("td",{className:"p-3 text-right flex justify-end gap-2",children:[(0,t.jsx)("button",{onClick:()=>{u(e.id),g({name:e.name,role:e.role})},className:"p-1.5 text-blue-600 hover:bg-blue-50 rounded",title:"Sửa",children:(0,t.jsx)(n,{size:16})}),(0,t.jsx)("button",{onClick:()=>f(e.id,e.is_active),className:`p-1.5 rounded transition-colors ${e.is_active?"text-red-500 hover:bg-red-50":"text-green-500 hover:bg-green-50"}`,title:e.is_active?"Ẩn nhân viên":"Kích hoạt lại",children:e.is_active?(0,t.jsx)(i.Trash2,{size:16}):(0,t.jsx)(c.Save,{size:16})})]})]},e.id))})]})})]})}var h=e.i(55436),m=e.i(84614),u=e.i(27516),p=e.i(90392);function g(){let[e,r]=(0,s.useState)([]),[l,o]=(0,s.useState)(!1),[x,g]=(0,s.useState)(""),[b,y]=(0,s.useState)(null),[f,j]=(0,s.useState)({}),[v,N]=(0,s.useState)(null);async function k(){o(!0);let{data:e}=await a.supabase.from("patients").select("*").order("created_at",{ascending:!1}).limit(20);e&&r(e),o(!1)}async function w(){if(!x)return void k();o(!0);let{data:e}=await a.supabase.from("patients").select("*").or(`full_name.ilike.%${x}%,cccd.eq.${x}`).limit(20);e&&r(e),o(!1)}async function C(){if(!b)return;let{error:t}=await a.supabase.from("patients").update(f).eq("id",b);t?alert("Lỗi khi lưu!"):(o(!0),r(e.map(e=>e.id===b?{...e,...f}:e)),y(null),o(!1))}async function S(t){if(!confirm("Hành động này không thể hoàn tác. Bạn chắc chắn chứ?"))return;o(!0),await a.supabase.from("visits").delete().eq("patient_id",t);let{error:s}=await a.supabase.from("patients").delete().eq("id",t);s?alert("Lỗi khi xóa: "+s.message):(r(e.filter(e=>e.id!==t)),alert("Đã xóa bệnh nhân thành công.")),o(!1)}return(0,s.useEffect)(()=>{k()},[]),(0,t.jsxs)("div",{className:"bg-white p-6 rounded-xl border shadow-sm",children:[(0,t.jsxs)("h3",{className:"text-lg font-bold mb-4 flex items-center gap-2",children:[(0,t.jsx)(m.User,{size:20,className:"text-primary"})," Quản lý Bệnh nhân"]}),(0,t.jsxs)("div",{className:"flex gap-2 mb-6",children:[(0,t.jsx)("input",{type:"text",className:"flex-1 border p-2 rounded-lg text-sm",placeholder:"Tìm theo Tên hoặc CCCD...",value:x,onChange:e=>g(e.target.value),onKeyDown:e=>"Enter"===e.key&&w()}),(0,t.jsxs)("button",{onClick:w,className:"bg-primary text-white px-4 py-2 rounded-lg hover:bg-blue-600 transition-colors flex items-center gap-2 text-sm",children:[(0,t.jsx)(h.Search,{size:16})," Tìm kiếm"]})]}),(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsxs)("table",{className:"w-full text-sm text-left",children:[(0,t.jsx)("thead",{className:"bg-gray-100 text-gray-600 font-medium",children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{className:"p-3 rounded-tl-lg",children:"CCCD"}),(0,t.jsx)("th",{className:"p-3",children:"Họ tên"}),(0,t.jsx)("th",{className:"p-3",children:"Năm sinh"}),(0,t.jsx)("th",{className:"p-3",children:"SĐT"}),(0,t.jsx)("th",{className:"p-3",children:"Địa chỉ"}),(0,t.jsx)("th",{className:"p-3 rounded-tr-lg text-right",children:"Sửa"})]})}),(0,t.jsxs)("tbody",{className:"divide-y",children:[l&&(0,t.jsx)("tr",{children:(0,t.jsx)("td",{colSpan:6,className:"p-4 text-center text-gray-400",children:"Đang tải..."})}),!l&&0===e.length&&(0,t.jsx)("tr",{children:(0,t.jsx)("td",{colSpan:6,className:"p-4 text-center text-gray-400 italic",children:"Nhập từ khóa để tìm kiếm..."})}),e.map(e=>(0,t.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,t.jsx)("td",{className:"p-3",children:b===e.id?(0,t.jsx)("input",{value:f.cccd||"",onChange:e=>j({...f,cccd:e.target.value}),className:"w-full border p-1 rounded"}):e.cccd}),(0,t.jsx)("td",{className:"p-3 font-medium",children:b===e.id?(0,t.jsx)("input",{value:f.full_name||"",onChange:e=>j({...f,full_name:e.target.value}),className:"w-full border p-1 rounded"}):e.full_name}),(0,t.jsx)("td",{className:"p-3",children:b===e.id?(0,t.jsx)("input",{type:"date",value:f.dob?new Date(f.dob).toISOString().split("T")[0]:"",onChange:e=>j({...f,dob:e.target.value}),className:"w-24 border p-1 rounded"}):e.dob?new Date(e.dob).getFullYear():"-"}),(0,t.jsx)("td",{className:"p-3",children:b===e.id?(0,t.jsx)("input",{value:f.phone||"",onChange:e=>j({...f,phone:e.target.value}),className:"w-full border p-1 rounded"}):e.phone}),(0,t.jsx)("td",{className:"p-3 max-w-[200px] truncate",title:e.address||"",children:b===e.id?(0,t.jsx)("input",{value:f.address||"",onChange:e=>j({...f,address:e.target.value}),className:"w-full border p-1 rounded"}):e.address}),(0,t.jsx)("td",{className:"p-3 text-right",children:b===e.id?(0,t.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,t.jsx)("button",{onClick:C,className:"text-green-600 hover:bg-green-50 p-1.5 rounded",children:(0,t.jsx)(c.Save,{size:16})}),(0,t.jsx)("button",{onClick:()=>y(null),className:"text-gray-500 hover:bg-gray-100 p-1.5 rounded",children:(0,t.jsx)(d.X,{size:16})})]}):(0,t.jsxs)("div",{className:"flex gap-1 justify-end",children:[(0,t.jsx)("button",{onClick:()=>{y(e.id),j({...e})},className:"text-blue-600 hover:bg-blue-50 p-1.5 rounded",title:"Sửa",children:(0,t.jsx)(n,{size:16})}),(0,t.jsx)("button",{onClick:()=>N(e),className:"text-purple-600 hover:bg-purple-50 p-1.5 rounded",title:"Xem bệnh sử",children:(0,t.jsx)(u.History,{size:16})}),(0,t.jsx)("button",{onClick:()=>{confirm(`CẢNH B\xc1O: X\xf3a bệnh nh\xe2n ${e.full_name} sẽ x\xf3a to\xe0n bộ lịch sử kh\xe1m!
Bạn c\xf3 chắc chắn kh\xf4ng?`)&&S(e.id)},className:"text-red-600 hover:bg-red-50 p-1.5 rounded",title:"Xóa vĩnh viễn",children:(0,t.jsx)(i.Trash2,{size:16})})]})})]},e.id))]})]})}),v&&(0,t.jsx)(p.default,{patient:v,onClose:()=>N(null)})]})}let b=(0,l.default)("Tag",[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]]);var y=e.i(69638),f=e.i(63209);function j(){let[e,l]=(0,s.useState)([]),[o,x]=(0,s.useState)(!1),[h,m]=(0,s.useState)({name:"",price:""}),[u,p]=(0,s.useState)(null),[g,j]=(0,s.useState)({price:"",name:""}),[v,N]=(0,s.useState)(null);async function k(){x(!0);let{data:e,error:t}=await a.supabase.from("service_catalog").select("*").order("id",{ascending:!0});e?l(e):t&&(console.error(t),"42P01"===t.code&&N({type:"error",text:'Bảng dữ liệu "service_catalog" chưa được tạo. Vui lòng chạy SQL trong db/schema.sql'})),x(!1)}async function w(){if(!h.name||!h.price)return;x(!0);let{error:e}=await a.supabase.from("service_catalog").insert([{name:h.name,price:Number(h.price),is_active:!0}]);e?N({type:"error",text:"Lỗi: "+e.message}):(m({name:"",price:""}),k(),N({type:"success",text:"Thêm dịch vụ thành công"})),x(!1)}async function C(e){x(!0);let{error:t}=await a.supabase.from("service_catalog").update({name:g.name,price:Number(g.price)}).eq("id",e);t?N({type:"error",text:"Lỗi cập nhật: "+t.message}):(p(null),k(),N({type:"success",text:"Cập nhật thành công"})),x(!1)}async function S(e,t){let{error:s}=await a.supabase.from("service_catalog").update({is_active:!t}).eq("id",e);s||k()}async function z(e){if(!confirm("Bạn có chắc muốn xóa dịch vụ này?"))return;let{error:t}=await a.supabase.from("service_catalog").delete().eq("id",e);t?N({type:"error",text:"Lỗi xóa: "+t.message}):(k(),N({type:"success",text:"Đã xóa dịch vụ"}))}return(0,s.useEffect)(()=>{k()},[]),(0,t.jsxs)("div",{className:"bg-white p-6 rounded-xl border shadow-sm",children:[(0,t.jsxs)("h3",{className:"text-lg font-bold mb-6 flex items-center gap-2",children:[(0,t.jsx)(b,{size:20,className:"text-primary"})," Quản lý Dịch vụ & Bảng giá"]}),(0,t.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg mb-6 flex gap-3 items-end border",children:[(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Tên dịch vụ"}),(0,t.jsx)("input",{className:"w-full border p-2 rounded text-sm",placeholder:"Ví dụ: Siêu âm bụng, X-Quang...",value:h.name,onChange:e=>m({...h,name:e.target.value})})]}),(0,t.jsxs)("div",{className:"w-40",children:[(0,t.jsx)("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Đơn giá (VNĐ)"}),(0,t.jsx)("input",{type:"number",className:"w-full border p-2 rounded text-sm",placeholder:"0",value:h.price,onChange:e=>m({...h,price:e.target.value})})]}),(0,t.jsxs)("button",{onClick:w,disabled:o||!h.name||!h.price,className:"bg-primary text-white px-4 py-2 rounded hover:bg-blue-600 disabled:opacity-50 flex items-center gap-2 text-sm h-[38px]",children:[(0,t.jsx)(r.Plus,{size:16})," Thêm"]})]}),v&&(0,t.jsxs)("div",{className:`mb-4 p-3 rounded flex items-center gap-2 text-sm ${"success"===v.type?"bg-green-50 text-green-700":"bg-red-50 text-red-700"}`,children:["success"===v.type?(0,t.jsx)(y.CheckCircle,{size:16}):(0,t.jsx)(f.AlertCircle,{size:16}),v.text]}),(0,t.jsx)("div",{className:"overflow-hidden border rounded-lg",children:(0,t.jsxs)("table",{className:"w-full text-sm text-left",children:[(0,t.jsx)("thead",{className:"bg-gray-100 text-gray-600 font-medium",children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{className:"p-3",children:"Tên dịch vụ"}),(0,t.jsx)("th",{className:"p-3 text-right",children:"Đơn giá"}),(0,t.jsx)("th",{className:"p-3 text-center",children:"Trạng thái"}),(0,t.jsx)("th",{className:"p-3 text-right",children:"Thao tác"})]})}),(0,t.jsxs)("tbody",{className:"divide-y",children:[0===e.length&&!o&&(0,t.jsx)("tr",{children:(0,t.jsx)("td",{colSpan:4,className:"p-4 text-center text-gray-400",children:"Chưa có dịch vụ nào."})}),e.map(e=>(0,t.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,t.jsx)("td",{className:"p-3",children:u===e.id?(0,t.jsx)("input",{value:g.name,onChange:e=>j({...g,name:e.target.value}),className:"border p-1 rounded w-full"}):(0,t.jsx)("span",{className:e.is_active?"":"text-gray-400 line-through",children:e.name})}),(0,t.jsx)("td",{className:"p-3 text-right font-mono",children:u===e.id?(0,t.jsx)("input",{type:"number",value:g.price,onChange:e=>j({...g,price:e.target.value}),className:"border p-1 rounded w-32 text-right"}):e.price.toLocaleString("vi-VN")+" ₫"}),(0,t.jsx)("td",{className:"p-3 text-center",children:(0,t.jsx)("button",{onClick:()=>S(e.id,e.is_active),className:`px-2 py-0.5 rounded text-xs border ${e.is_active?"bg-green-50 text-green-700 border-green-200":"bg-gray-100 text-gray-500 border-gray-200"}`,children:e.is_active?"Đang dùng":"Đã ẩn"})}),(0,t.jsx)("td",{className:"p-3 text-right",children:u===e.id?(0,t.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,t.jsx)("button",{onClick:()=>C(e.id),className:"text-green-600 p-1 hover:bg-green-50 rounded",children:(0,t.jsx)(c.Save,{size:16})}),(0,t.jsx)("button",{onClick:()=>p(null),className:"text-gray-500 p-1 hover:bg-gray-100 rounded",children:(0,t.jsx)(d.X,{size:16})})]}):(0,t.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,t.jsx)("button",{onClick:()=>{p(e.id),j({name:e.name,price:e.price.toString()})},className:"text-blue-600 p-1 hover:bg-blue-50 rounded",children:(0,t.jsx)(n,{size:16})}),(0,t.jsx)("button",{onClick:()=>z(e.id),className:"text-red-600 p-1 hover:bg-red-50 rounded",children:(0,t.jsx)(i.Trash2,{size:16})})]})})]},e.id))]})]})})]})}var v=e.i(12156);function N(){let[e,l]=(0,s.useState)([]),[o,x]=(0,s.useState)(!1),[h,m]=(0,s.useState)({name:"",unit:""}),[u,p]=(0,s.useState)(null),[g,b]=(0,s.useState)({name:"",unit:""}),[j,N]=(0,s.useState)(null);async function k(){x(!0);let{data:e,error:t}=await a.supabase.from("medications").select("id, name, unit, is_active").order("name",{ascending:!0});e?l(e):t&&(console.error("Error fetching meds:",t),N({type:"error",text:"Lỗi tải danh sách thuốc: "+(t.message||"Không rõ")})),x(!1)}async function w(){if(!h.name||!h.unit)return;x(!0);let{error:e}=await a.supabase.from("medications").insert([{name:h.name,unit:h.unit,is_active:!0}]);e?N({type:"error",text:"Lỗi: "+e.message}):(m({name:"",unit:""}),k(),N({type:"success",text:"Thêm thuốc thành công"})),x(!1)}async function C(e){x(!0);let{error:t}=await a.supabase.from("medications").update({name:g.name,unit:g.unit}).eq("id",e);t?N({type:"error",text:"Lỗi cập nhật: "+t.message}):(p(null),k(),N({type:"success",text:"Cập nhật thành công"})),x(!1)}async function S(e,t){let{error:s}=await a.supabase.from("medications").update({is_active:!t}).eq("id",e);s||k()}async function z(e){if(!confirm("Bạn có chắc muốn xóa thuốc này?"))return;let{error:t}=await a.supabase.from("medications").delete().eq("id",e);t?N({type:"error",text:"Lỗi xóa: "+t.message}):(k(),N({type:"success",text:"Đã xóa thuốc"}))}return(0,s.useEffect)(()=>{k()},[]),(0,t.jsxs)("div",{className:"bg-white p-6 rounded-xl border shadow-sm",children:[(0,t.jsxs)("h3",{className:"text-lg font-bold mb-6 flex items-center gap-2",children:[(0,t.jsx)(v.Pill,{size:20,className:"text-primary"})," Danh sách Thuốc (Đơn giản)"]}),(0,t.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg mb-6 flex gap-3 items-end border",children:[(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Tên thuốc"}),(0,t.jsx)("input",{className:"w-full border p-2 rounded text-sm",placeholder:"Ví dụ: Paracetamol 500mg...",value:h.name,onChange:e=>m({...h,name:e.target.value})})]}),(0,t.jsxs)("div",{className:"w-32",children:[(0,t.jsx)("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Đơn vị"}),(0,t.jsx)("input",{className:"w-full border p-2 rounded text-sm",placeholder:"Viên, Vỉ...",value:h.unit,onChange:e=>m({...h,unit:e.target.value})})]}),(0,t.jsxs)("button",{onClick:w,disabled:o||!h.name||!h.unit,className:"bg-primary text-white px-4 py-2 rounded hover:bg-blue-600 disabled:opacity-50 flex items-center gap-2 text-sm h-[38px]",children:[(0,t.jsx)(r.Plus,{size:16})," Thêm"]})]}),j&&(0,t.jsxs)("div",{className:`mb-4 p-3 rounded flex items-center gap-2 text-sm ${"success"===j.type?"bg-green-50 text-green-700":"bg-red-50 text-red-700"}`,children:["success"===j.type?(0,t.jsx)(y.CheckCircle,{size:16}):(0,t.jsx)(f.AlertCircle,{size:16}),j.text]}),(0,t.jsx)("div",{className:"overflow-hidden border rounded-lg",children:(0,t.jsxs)("table",{className:"w-full text-sm text-left",children:[(0,t.jsx)("thead",{className:"bg-gray-100 text-gray-600 font-medium",children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{className:"p-3",children:"Tên thuốc"}),(0,t.jsx)("th",{className:"p-3 w-32",children:"Đơn vị"}),(0,t.jsx)("th",{className:"p-3 text-center w-32",children:"Trạng thái"}),(0,t.jsx)("th",{className:"p-3 text-right w-24",children:"Thao tác"})]})}),(0,t.jsxs)("tbody",{className:"divide-y",children:[0===e.length&&!o&&(0,t.jsx)("tr",{children:(0,t.jsx)("td",{colSpan:4,className:"p-4 text-center text-gray-400",children:"Danh sách trống."})}),e.map(e=>(0,t.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,t.jsx)("td",{className:"p-3",children:u===e.id?(0,t.jsx)("input",{value:g.name,onChange:e=>b({...g,name:e.target.value}),className:"border p-1 rounded w-full"}):(0,t.jsxs)("div",{className:"font-medium",children:[e.name,!e.is_active&&(0,t.jsx)("span",{className:"ml-2 text-xs bg-gray-200 text-gray-500 px-1 rounded",children:"Đã ẩn"})]})}),(0,t.jsx)("td",{className:"p-3",children:u===e.id?(0,t.jsx)("input",{value:g.unit,onChange:e=>b({...g,unit:e.target.value}),className:"border p-1 rounded w-full"}):(0,t.jsx)("span",{className:"text-gray-500",children:e.unit})}),(0,t.jsx)("td",{className:"p-3 text-center",children:(0,t.jsx)("button",{onClick:()=>S(e.id,e.is_active),className:`px-2 py-0.5 rounded text-xs border ${e.is_active?"bg-green-50 text-green-700 border-green-200":"bg-gray-100 text-gray-500 border-gray-200"}`,children:e.is_active?"Hiện":"Ẩn"})}),(0,t.jsx)("td",{className:"p-3 text-right",children:u===e.id?(0,t.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,t.jsx)("button",{onClick:()=>C(e.id),className:"text-green-600 p-1 hover:bg-green-50 rounded",children:(0,t.jsx)(c.Save,{size:16})}),(0,t.jsx)("button",{onClick:()=>p(null),className:"text-gray-500 p-1 hover:bg-gray-100 rounded",children:(0,t.jsx)(d.X,{size:16})})]}):(0,t.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,t.jsx)("button",{onClick:()=>{p(e.id),b({name:e.name,unit:e.unit})},className:"text-blue-600 p-1 hover:bg-blue-50 rounded",children:(0,t.jsx)(n,{size:16})}),(0,t.jsx)("button",{onClick:()=>z(e.id),className:"text-red-600 p-1 hover:bg-red-50 rounded",children:(0,t.jsx)(i.Trash2,{size:16})})]})})]},e.id))]})]})})]})}let k=(0,l.default)("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);var w=e.i(61911);function C(){let[e,a]=(0,s.useState)("staff");return(0,t.jsxs)("div",{className:"container mx-auto p-4 max-w-6xl",children:[(0,t.jsxs)("header",{className:"mb-8",children:[(0,t.jsxs)("h1",{className:"text-3xl font-bold text-gray-800 flex items-center gap-2",children:[(0,t.jsx)(k,{className:"text-primary",size:32}),"Quản trị Hệ thống"]}),(0,t.jsx)("p",{className:"text-gray-500 mt-2",children:"Quản lý nhân sự, dịch vụ và kho thuốc"})]}),(0,t.jsxs)("div",{className:"flex gap-2 mb-6 border-b overflow-x-auto",children:[(0,t.jsxs)("button",{onClick:()=>a("staff"),className:`px-6 py-3 font-medium text-sm flex items-center gap-2 border-b-2 transition-colors whitespace-nowrap ${"staff"===e?"border-primary text-primary":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[(0,t.jsx)(w.Users,{size:18})," Nhân sự"]}),(0,t.jsxs)("button",{onClick:()=>a("patients"),className:`px-6 py-3 font-medium text-sm flex items-center gap-2 border-b-2 transition-colors whitespace-nowrap ${"patients"===e?"border-primary text-primary":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[(0,t.jsx)(w.Users,{size:18})," Bệnh nhân"]}),(0,t.jsxs)("button",{onClick:()=>a("services"),className:`px-6 py-3 font-medium text-sm flex items-center gap-2 border-b-2 transition-colors whitespace-nowrap ${"services"===e?"border-primary text-primary":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[(0,t.jsx)(b,{size:18})," Dịch vụ & Giá"]}),(0,t.jsxs)("button",{onClick:()=>a("medications"),className:`px-6 py-3 font-medium text-sm flex items-center gap-2 border-b-2 transition-colors whitespace-nowrap ${"medications"===e?"border-primary text-primary":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[(0,t.jsx)(v.Pill,{size:18})," Kho Thuốc"]})]}),(0,t.jsxs)("main",{className:"animate-in fade-in duration-300",children:["staff"===e&&(0,t.jsx)(x,{}),"patients"===e&&(0,t.jsx)(g,{}),"services"===e&&(0,t.jsx)(j,{}),"medications"===e&&(0,t.jsx)(N,{})]})]})}e.s(["default",()=>C],72906)}]);